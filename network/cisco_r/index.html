
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../sonic/">
      
      
        <link rel="next" href="../juniper_mx/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.17">
    
    
      
        <title>Router cisco - My Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.bcfcd587.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="My Docs" class="md-header__button md-logo" aria-label="My Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            My Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Router cisco
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="My Docs" class="md-nav__button md-logo" aria-label="My Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    My Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    monitoring
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            monitoring
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../monitoring/a1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Применение Victoriametrics для мониторинга по SNMP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../monitoring/a2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Применение Victoriametrics для мониторинга VMware vCenter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../monitoring/promql_metricql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PromQL, MetricQL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../monitoring/snmp_exporter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vmagent, snmp_exporter (old)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../monitoring/snmp_exporter_20/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    snmp_exporter 0.20
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../monitoring/backbox_exporter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vmagent, blackbox_exporter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../monitoring/telegraf_vmagent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Telegraf vs vmagent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../monitoring/telegraf_snmp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Telegraf snmp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../monitoring/sflow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    netflow, sflow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../monitoring/logs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    logs
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    network
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            network
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../errors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interface Errors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../switching/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Switching
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dhcpsnooping/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DHCP snooping
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nlb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NLB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tcp_mss/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TCP MSS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../flowcontrol/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flowcontrol
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../poe/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PoE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    СКС
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../distkontrol/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Device DistKontrol
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../esxi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Esxi
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../qos_switch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Switch QoS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vxlan_sw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Switch list for vxlan
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cisco_sw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Switch cisco
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nexus3k/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Switch cisco nexus3k
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nexus9k/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Switch cisco nexus9k
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mds/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Switch cisco mds
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../juniper_ex/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Switch juniper ex
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../huawei/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Switch huawei s57
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eltex/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Switch eltex
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../extreme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Switch extreme
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tfortis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Switch tfortis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sonic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Switch mellanox sonic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Router cisco
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Router cisco
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      совет
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aux" class="md-nav__link">
    <span class="md-ellipsis">
      aux
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aaa-tacacs" class="md-nav__link">
    <span class="md-ellipsis">
      aaa для tacacs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#logging" class="md-nav__link">
    <span class="md-ellipsis">
      logging
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cisco-4321-throughput" class="md-nav__link">
    <span class="md-ellipsis">
      cisco 4321 throughput
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#output-service-policy" class="md-nav__link">
    <span class="md-ellipsis">
      output service-policy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eem" class="md-nav__link">
    <span class="md-ellipsis">
      eem
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kron" class="md-nav__link">
    <span class="md-ellipsis">
      kron
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tcp-mss" class="md-nav__link">
    <span class="md-ellipsis">
      tcp-mss
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#frame-relay-rtp-compression" class="md-nav__link">
    <span class="md-ellipsis">
      frame-relay, rtp compression
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#acl" class="md-nav__link">
    <span class="md-ellipsis">
      acl
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session-mib" class="md-nav__link">
    <span class="md-ellipsis">
      session mib
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backup-interface" class="md-nav__link">
    <span class="md-ellipsis">
      backup interface
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#object-group" class="md-nav__link">
    <span class="md-ellipsis">
      object group
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#acl-for-default-route" class="md-nav__link">
    <span class="md-ellipsis">
      acl for default route
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#copp" class="md-nav__link">
    <span class="md-ellipsis">
      copp
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#high-cpu-usage" class="md-nav__link">
    <span class="md-ellipsis">
      high cpu usage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#netflow-ios" class="md-nav__link">
    <span class="md-ellipsis">
      netflow для ios
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#neflow-ios-xe" class="md-nav__link">
    <span class="md-ellipsis">
      neflow для ios xe
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../juniper_mx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Router juniper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vyos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Router vyos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vipnet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FW vipnet
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    voip
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            voip
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../voip/softphone/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Softphones
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../voip/freeswitch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Freeswitch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../voip/cisco_e1_gateway/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cisco E1 gateway
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../voip/cisco_gw_cdr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cisco CDR for gateway
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../voip/cisco_cme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cisco CME(CUCME)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../voip/cisco_cor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cisco COR list
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../voip/cisco_cube/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cisco CUBE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../voip/cisco_voip/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cisco voip notes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    work
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            work
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../work/adguardhome/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AdGuardHome
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../work/ansible_ntwrk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ansible for ntwrk
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../work/empty/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Empty, sshpass
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../work/github/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    github
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../work/miniconda/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Miniconda
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../work/mkdocs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mkdocs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../work/molecule/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Molecule
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../work/msys2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Msys2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../work/venv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pip, venv
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../work/app_proxy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Proxy for app
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../work/tacacs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tacacs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../work/webtftp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Web,tftp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../work/translit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Translit, recode
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../work/vim/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vim
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../work/ubuntu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ubuntu
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../work/usbwrite/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    USB writer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    info
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            info
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../info/mac_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mac address
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../info/mail_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mail
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../info/www_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Web
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../info/phone_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Phone number
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../info/dns_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dns servers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../info/routing_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Routing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../info/speedtest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Speed test
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      совет
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aux" class="md-nav__link">
    <span class="md-ellipsis">
      aux
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aaa-tacacs" class="md-nav__link">
    <span class="md-ellipsis">
      aaa для tacacs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#logging" class="md-nav__link">
    <span class="md-ellipsis">
      logging
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cisco-4321-throughput" class="md-nav__link">
    <span class="md-ellipsis">
      cisco 4321 throughput
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#output-service-policy" class="md-nav__link">
    <span class="md-ellipsis">
      output service-policy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eem" class="md-nav__link">
    <span class="md-ellipsis">
      eem
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kron" class="md-nav__link">
    <span class="md-ellipsis">
      kron
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tcp-mss" class="md-nav__link">
    <span class="md-ellipsis">
      tcp-mss
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#frame-relay-rtp-compression" class="md-nav__link">
    <span class="md-ellipsis">
      frame-relay, rtp compression
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#acl" class="md-nav__link">
    <span class="md-ellipsis">
      acl
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session-mib" class="md-nav__link">
    <span class="md-ellipsis">
      session mib
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backup-interface" class="md-nav__link">
    <span class="md-ellipsis">
      backup interface
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#object-group" class="md-nav__link">
    <span class="md-ellipsis">
      object group
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#acl-for-default-route" class="md-nav__link">
    <span class="md-ellipsis">
      acl for default route
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#copp" class="md-nav__link">
    <span class="md-ellipsis">
      copp
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#high-cpu-usage" class="md-nav__link">
    <span class="md-ellipsis">
      high cpu usage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#netflow-ios" class="md-nav__link">
    <span class="md-ellipsis">
      netflow для ios
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#neflow-ios-xe" class="md-nav__link">
    <span class="md-ellipsis">
      neflow для ios xe
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Router cisco</h1>

<h2 id="_1">совет</h2>
<p>Вот ссылка на <a href="https://www.cisco.com/c/en/us/support/docs/ip/access-lists/13608-21.html">Guide to Harden Cisco IOS Devices</a>.
Там и vstack уже есть для коммутаторов.</p>
<h2 id="aux">aux</h2>
<p>Наверное, в каждом маршрутизаторе cisco такой порт есть и он позволяет настраивать удаленно через консоль другое оборудование.
Для этого нужен пачкодр обжатый с одной стороны в обратном порядке. Ну, в общем, rj45 коннектор перевернуть и обжать.
Скорее всего можно было проще настроить, но вот столько команд в линии сейчас:
<div class="highlight"><pre><span></span><code>line aux 0
 session-timeout 5 
 exec-timeout 5 0
 absolute-timeout 60
 modem InOut
 no exec
 transport preferred telnet
 transport input all
</code></pre></div>
Узнать порт линии командой <code>sh line</code>. Напротив AUX будет номер и чаще это 1. Реже 65. Т.о. надо выполнить telnet на порт 2001 маршрутизатора.
Сброс линии <code>clear line aux 0</code></p>
<h2 id="aaa-tacacs">aaa для tacacs</h2>
<p>Для версии IOS 15.7
<div class="highlight"><pre><span></span><code>aaa new-model
!
!
aaa authentication login default group tacacs+ local
aaa authentication enable default group tacacs+ enable none
aaa authorization console
aaa authorization exec default group tacacs+ local 
aaa accounting commands 15 default
 action-type start-stop
 group tacacs+
!
aaa accounting network default
 action-type start-stop
 group tacacs+
!
aaa accounting connection default
 action-type start-stop
 group tacacs+
!
aaa accounting system default
 action-type start-stop
 group tacacs+
</code></pre></div>
Сам tacacs тоже надо прописать. Есть легаси <code>tacacs-server host ...</code>, есть рекомендованный вариант с группами.</p>
<p>Для IOS XE все более привычно как было в 12 ветке ios.
<div class="highlight"><pre><span></span><code>aaa new-model
!
!
aaa authentication login default group tacacs+ local
aaa authentication enable default group tacacs+ enable none
aaa authorization console
aaa authorization exec default group tacacs+ local 
aaa accounting commands 15 default start-stop group tacacs+
aaa accounting network default start-stop group tacacs+
aaa accounting connection default start-stop group tacacs+
aaa accounting system default start-stop group tacacs+
</code></pre></div></p>
<h2 id="logging">logging</h2>
<p>Про aux писал выше. Если остался кабель, то в устройстве надо выключить логирование в консоль.
В противном случае в логах такакса будет много чего почитать.
<div class="highlight"><pre><span></span><code>no logging console
</code></pre></div>
В консоли и vty прописать
<div class="highlight"><pre><span></span><code>line con 0
 logging synchronous
line vty 0 4
 logging synchronous
</code></pre></div>
Фильтрация сообщений. Например, трансивер левый показывает некорректную температуру, чем создает сообщения от шасси в логах
<div class="highlight"><pre><span></span><code>%SFF8472-5-THRESHOLD_VIOLATION: Te1/2: Temperature low alarm; Operating value: -127.2 C, Threshold value:   -4.0 C.
%SFF8472-5-THRESHOLD_VIOLATION: Te1/2: Temperature high alarm; Operating value:  118.0 C, Threshold value:   74.0 C.
</code></pre></div>
<div class="highlight"><pre><span></span><code>logging discriminator FIX mnemonics drops THRESHOLD_VIOLATION 
logging buffered discriminator FIX
logging host 10.9.8.1 discriminator FIX
</code></pre></div>
По <code>sh logging</code> можно увидеть активные дискриминаторы и счетчики дропов <code>message lines dropped-by-MD</code>.</p>
<p>Время в логах:
<div class="highlight"><pre><span></span><code>service timestamps debug datetime msec localtime
service timestamps log datetime msec localtime
</code></pre></div></p>
<h2 id="cisco-4321-throughput">cisco 4321 throughput</h2>
<p>После пробного периода использования throughput лицензии в 4321 (16.9.4), она становится Life time и RightToUse.
<div class="highlight"><pre><span></span><code>license accept end user agreement
platform hardware throughput level 100000
</code></pre></div>
Это на прием и передачу. Как мало.
<div class="highlight"><pre><span></span><code>c4321#sh ver | in throughput
The current throughput level is 100000 kbps
c4321#sh lic | beg throughput
Index 9 Feature: throughput
        Period left: Life time
        License Type: RightToUse
        License State: Active, In Use
        License Count: Non-Counted
</code></pre></div></p>
<h2 id="output-service-policy">output service-policy</h2>
<p>Приоритезировать трафик на сабинтерфейсы в рамках какой-то полосы
<div class="highlight"><pre><span></span><code>policy-map myservice
 class Voip
  priority 128
 class class-default
  fair-queue
</code></pre></div>
Попытка применить.
<div class="highlight"><pre><span></span><code>router(config-subif)#service-policy output myservice
CBWFQ : Not supported on subinterfaces
</code></pre></div>
Надо переделать и прописать политику в шейпер дефолтового класса. И уже эту политику применить.
<div class="highlight"><pre><span></span><code>policy-map 512k
 class class-default
  shape average 512000
  service-policy myservice

router(config-subif)#service-policy output 512k
</code></pre></div></p>
<h2 id="eem">eem</h2>
<p>Периодические проблемы с потоком Е1 на голосовом шлюзе Cisco. Cкрипт, выключающий ночью D-канал.
<div class="highlight"><pre><span></span><code>event manager session cli username &quot;operator&quot;
event manager applet restartd
 event timer cron cron-entry &quot;26 4 * * *&quot; maxrun 120
 action 1.0 syslog msg &quot;restart d-channel&quot;
 action 2.0 cli command &quot;enable&quot;
 action 3.0 cli command &quot;conf t&quot;
 action 4.0 cli command &quot;voice-port 0/0/0:15&quot;
 action 5.0 cli command &quot;shutdown&quot;
 action 6.0 wait 30
 action 7.0 cli command &quot;no shutdown&quot;
 action 8.0 cli command &quot;end&quot;
</code></pre></div></p>
<h2 id="kron">kron</h2>
<p>Периодическая перезагрузка по расписанию
<div class="highlight"><pre><span></span><code>kron occurrence reboot at 4:00 13 recurring
 policy-list reboot
!
kron policy-list reboot
 cli reload
</code></pre></div></p>
<h2 id="tcp-mss">tcp-mss</h2>
<p>Описано в <a href="/network/tcp_mss/">/network/tcp_mss/</a>
<div class="highlight"><pre><span></span><code>ip tcp adjust-mss &lt;значение&gt;
</code></pre></div></p>
<h2 id="frame-relay-rtp-compression">frame-relay, rtp compression</h2>
<p>В целом, протокол полезный:</p>
<ul>
<li>Frame-relay позволяет создавать виртуальные каналы в пределах одного физического интерфейса. Инкапсуляции HDLC, PPP такого не позволяют;</li>
<li>Для каждого логического интерфейса можно выделить полосу, настроить QoS;</li>
<li>Один из логических интерфейсов можно включить в bridge-группу с ethernet'ом, к примеру;</li>
<li>Можно настроить frame-relay switching и так передавать данные между виртуальными каналами;</li>
<li>У VoFR самое эффективное использование полосы при передаче голоса;</li>
<li>MFR работает лучше Multilink PPP. Меньше rtt, субъективно стабильнее.</li>
</ul>
<p>Раньше передача данных осуществлялась по очень дорогим спутниковым каналам или дорогим цифровым междугородним/международным каналам связи.
Качество "голоса" и рациональное использование полосы за счет мультиплексирования виртуальных каналов позволяли операторам оказывать мультисервисные услуги связи.
Компрессия заголовков работает только на WAN интерфейсах с PPP,HDLC,FR-инкапсуляцией.
Пример:
<div class="highlight"><pre><span></span><code>interface Serial0/2/0:0.100 point-to-point
ip unnumbered Loopback0
frame-relay interface-dlci 100
frame-relay ip rtp header-compression

interface Serial0/1/0
ip unnumbered Loopback0
ip rtp header-compression
encapsulation ppp
</code></pre></div>
Из калькулятора:
<div class="highlight"><pre><span></span><code>Codec Bit Rate 8 kbps = (Codec Sample Size * 8) / (Codec Sample Interval)
Codec Sample Size 10 bytes size of each individual codec sample
Codec Sample Interval 10 msec the time it takes for a single sample

Codec: g729_All_Variants
Voice Payload Size: 20 bytes
Voice Protocol: VoIP
Compression: Not Applicable
Media Access: Ethernet
Tunnel/Security/Misc: None
Number of Calls: 1

Total Bandwidth (including Overhead) 32.76 kbps

Codec: g729_All_Variants
Voice Payload Size: 20 bytes
Voice Protocol: VoIP
Compression: off
Media Access: Frame-Relay
Tunnel/Security/Misc: None
Number of Calls: 1

Total Bandwidth (including Overhead) 28.14 kbps

Codec: g729_All_Variants
Voice Payload Size: 20 bytes
Voice Protocol: VoIP
Compression: on
Media Access: Frame-Relay
Tunnel/Security/Misc: None
Number of Calls: 1

Total Bandwidth (including Overhead) 12.18 kbps


Codec: g729_All_Variants
Voice Payload Size: 30 bytes
Voice Protocol: VoFR
Media Access: Not Applicable
Tunnel/Security/Misc: Not Applicable
Number of Calls: 1

Cisco IOS Total Bandwidth Needed for 1.0 Calls 10 kbps
</code></pre></div></p>
<h2 id="acl">acl</h2>
<p>Было сохранено в качестве памятки откуда-то. Как раз для случаев, когда "permit ip any any" почему-то "не работает".</p>
<p>Here’s a handy list of ACL entries to allow your devices to speak routing protocols, availability protocols, and some other stuff.
We’ll assume you have ACL 101 applied to your Ethernet inbound; your Ethernet has an IP of 192.168.0.1.</p>
<p>BGP : Runs on TCP/179 between the neighbors
<div class="highlight"><pre><span></span><code>access-list 101 permit tcp any host 192.168.0.1 eq 179
</code></pre></div>
EIGRP : Runs on its own protocol number from the source interface IP to the multicast address of 224.0.0.10
<div class="highlight"><pre><span></span><code>access-list 101 permit eigrp any host 224.0.0.10
</code></pre></div>
OSPF : Runs on its own protocol number from the source interface IP to the multicast address of 224.0.0.5; also talks to 224.0.0.6 for DR/BDR routers
<div class="highlight"><pre><span></span><code>access-list 101 permit ospf any host 224.0.0.5
access-list 101 permit ospf any host 224.0.0.6
</code></pre></div>
HSRP : Runs on UDP from the source interface IP to the multicast address of 224.0.0.2. I’ve seen in the past that it runs on UDP/1985, but I didn’t find any evidence of that in a quick Google for it. Can someone verify?
<div class="highlight"><pre><span></span><code>access-list 101 permit udp any host 224.0.0.2
</code></pre></div>
RIP : Runs on UDP/520 from the source interface IP to the multicast address of 224.0.0.9
<div class="highlight"><pre><span></span><code>access-list 101 permit udp any host 224.0.0.9 eq 520
</code></pre></div>
VRRP : Runs on its own protocol number from the source interface IP to the multicast address of 224.0.0.18
<div class="highlight"><pre><span></span><code>access-list 101 permit 112 any host 224.0.0.18
</code></pre></div>
GLBP : Runs on UDP from the source interface IP to the multicast address of 224.0.0.102
<div class="highlight"><pre><span></span><code>access-list 101 permit udp any host 224.0.0.102
</code></pre></div>
DHCPD (or bootps) : Runs on UDP/67 from 0.0.0.0 (since the client doesn’t have an address yet) to 255.255.255.255 (the broadcast).
<div class="highlight"><pre><span></span><code>access-list 101 permit udp any host 255.255.255.255 eq 67
</code></pre></div></p>
<h2 id="session-mib">session mib</h2>
<p>Это вообще времен диалапа и прочего доступа, когда использовались cisco в качестве AS и BRAS.
Так с сервера доступа Cisco AS5350 можно получить данные о состоянии цифровых модемов и тем самым судить о загрузке модемного пула:
<div class="highlight"><pre><span></span><code>cmSystemInstalledModem      1.3.6.1.4.1.9.9.47.1.1.1.0
cmSystemModemsInUse         1.3.6.1.4.1.9.9.47.1.1.6.0 
cmSystemModemsAvailable     1.3.6.1.4.1.9.9.47.1.1.7.0
cmSystemModemsUnavailable   1.3.6.1.4.1.9.9.47.1.1.8.0 
cmSystemModemsOffline       1.3.6.1.4.1.9.9.47.1.1.9.0
cmSystemModemsDead          1.3.6.1.4.1.9.9.47.1.1.10.0
</code></pre></div>
Можно запрашивать информацию, чтобы обработать далее по номеру доступа.
Нужно будет подсчитать каким-нибудь скриптом количество строк на каждый номер, если номеров доступа несколько
<div class="highlight"><pre><span></span><code>cpmActiveLocalPhoneNumber 1.3.6.1.4.1.9.10.19.1.3.1.1.13
</code></pre></div>
Количество PPPoE-сессий
<div class="highlight"><pre><span></span><code>cPppoeSystemCurrSessions 1.3.6.1.4.1.9.9.194.1.1.1
</code></pre></div>
Количество PPtP-сессий
<div class="highlight"><pre><span></span><code>cvpdnSystemSessionTotal  1.3.6.1.4.1.9.10.24.1.1.4.1.3
</code></pre></div>
Чтобы завершать сессии по протоколу snmp необходимо включить на серверах доступа
<div class="highlight"><pre><span></span><code>aaa session-mib disconnect
</code></pre></div>
И использовать MIB: CISCO-AAA-SESSION-MIB. Вот шаблон, на основе которого можно написать нужный shell-скрипт:
<div class="highlight"><pre><span></span><code>export MIBS=+CISCO-AAA-SESSION-MIB
#список активных пользователей
snmpwalk -v2c -c public $hostname casnUserId 
snmpwalk -v2c -c public $hostname casnUserId.$session_id
# вывод .. = &quot;login&quot;
# сброс сессии. используется community на запись
snmpset -v2c -c private $hostname casnDisconnect.$session_id i 1
# вывод .. = INTEGER: true(1)
</code></pre></div></p>
<h2 id="backup-interface">backup interface</h2>
<p>Фича <a href="https://www.cisco.com/c/en/us/td/docs/routers/access/1900/software/configuration/guide/Software_Configuration/backup.html">backup interface</a> может пригодится
в случае, когда ассиметрия недопустима, как например, при включении в маршрутизатор межсетевых экранов asa, где flow должен передаваться через один и тот же интерфейс в обе стороны.
Писал об этом <a href="http://prosto-seti.blogspot.com/2018/11/blog-post.html">тут</a>. Это был единственный раз когда данный функционал пригодился.
<div class="highlight"><pre><span></span><code>interface GigabitEthernet0/0
 description asa1-eth1
 ip address 10.1.1.97 255.255.255.252
!
interface GigabitEthernet0/1
 description asa2-eth1
 ip address 10.1.1.109 255.255.255.252
!
interface GigabitEthernet0/2
 description r2-gi0/2
 backup interface GigabitEthernet0/1
 ip address 10.1.1.104 255.255.255.254
 ip ospf network point-to-point

r1#sh int desc  
Interface                      Status         Protocol Description
Em0/0                          admin down     down     
Gi0/0                          up             up       asa1-eth1
Gi0/1                          standby mode   down     asa2-eth1
Gi0/2                          up             up       r2-gi0/2
</code></pre></div></p>
<h2 id="object-group">object group</h2>
<p>Можно использовать в acl, которые используются потом в PBR.</p>
<h2 id="acl-for-default-route">acl for default route</h2>
<p>Стандартный лист
<div class="highlight"><pre><span></span><code>access-list 10 permit 0.0.0.0
</code></pre></div>
Расширенный лист
<div class="highlight"><pre><span></span><code>access-list 100 permit ip host 0.0.0.0 host 0.0.0.0
</code></pre></div>
Префикс лист
<div class="highlight"><pre><span></span><code>ip prefix-list 1 permit 0.0.0.0/0
</code></pre></div></p>
<h2 id="copp">copp</h2>
<p>Открытые порты, сессии:
<div class="highlight"><pre><span></span><code>show control-plane host open-ports
</code></pre></div></p>
<p>Была уязвимость на маршрутизаторах, рекомендовали настраивать copp.
Политика с дропами, поэтому все указанное в acl как permit будет дропнуто.
В deny указываются ipsec пиры, если такие имеются. Разрешается обращения из приватной сети 10/8 практически без ограничений.
<div class="highlight"><pre><span></span><code>access-list 198 deny   tcp 10.0.0.0 0.255.255.255 any
access-list 198 permit tcp any any eq telnet
access-list 198 permit tcp any any eq bgp
access-list 198 permit tcp any any eq 161

access-list 199 permit udp any any eq 18999
access-list 199 deny   udp 10.0.0.0 0.255.255.255 any
access-list 199 deny   udp host ipsec-peer-ip any eq non500-isakmp
access-list 199 permit udp any any eq non500-isakmp
access-list 199 deny   udp host host ipsec-peer-ip any eq isakmp
access-list 199 permit udp any any eq isakmp
access-list 199 permit udp any any eq ntp
access-list 199 permit udp any any eq snmp

class-map match-all undesirable-tcp
 match access-group 198
class-map match-all undesirable-udp
 match access-group 199

policy-map copp
 class undesirable-udp
  drop
 class undesirable-tcp
  drop

control-plane
 service-policy input copp
</code></pre></div>
copp описан с примерами в rfc 2011 года <a href="https://tools.ietf.org/html/rfc6192">rfc6192</a>.</p>
<h2 id="high-cpu-usage">high cpu usage</h2>
<p>Для софтовых маршрутизаторов надо мониторить суммарный pps и сравнивать с графиком загрузки cpu.
При высокой загрузке надо смотреть <code>sh proc cpu history</code>, где фиксирутся на псевдографиках максимальные значения загрузки cpu.
При появлении override и ignored ошибок на интерфейсах менять маршрутизатор на более производительный, если дальнейшая оптимизация конфигурации невозможна.
Если загрузка cpu выросла внезапно, то проверить включен ли cef. Он может автоматически выключиться, если закончилась память, например.</p>
<h2 id="netflow-ios">netflow для ios</h2>
<p><div class="highlight"><pre><span></span><code>ip flow-cache timeout active 5
ip flow-export source Loopback0
ip flow-export version 5
ip flow-export destination &lt;ip&gt; &lt;port&gt;
ip flow-top-talkers
 top 50
 sort-by bytes
</code></pre></div>
На всех интерфейсах с ip-адресами включить <code>ip flow ingress</code>. Проверить сбор данных:
<div class="highlight"><pre><span></span><code>show ip flow top-talkers
show ip cache flow
</code></pre></div>
Есть разные коллекторы для netflow 5. Если ресурсы позвляют, то <a href="https://github.com/robcowart/elastiflow">elastiflow</a>.
Сложить netflow в tsdb (ifluxdb) это очень плохая идея и трата времени.</p>
<h2 id="neflow-ios-xe">neflow для ios xe</h2>
<p><div class="highlight"><pre><span></span><code>flow exporter DOH
 destination &lt;ip&gt;
 source Loopback0
 transport udp &lt;port&gt;
 export-protocol netflow-v5
!
!
flow monitor DOH
 exporter DOH
 cache timeout active 60
 record netflow-original
</code></pre></div>
На всех интерфейсах с ip-адресами включить <code>ip flow monitor DOH input</code>. Проверить сбор данных:
<div class="highlight"><pre><span></span><code>show flow monitor DOH statistics
show flow monitor DOH cache sort ipv4 tos format table
</code></pre></div>
Без коллектора никуда.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.1e8ae164.min.js"></script>
      
    
  </body>
</html>